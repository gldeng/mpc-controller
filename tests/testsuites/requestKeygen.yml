name: Request keygen test suite

vars:
  ROLE_MPC_ADMIN: 0x8e7D0f159e992cfC0ee28D55C600106482a818Ea
  ROLE_MPC_ADMIN_PK: a87518b3691061b9de6dd281d2dda06a4fe3a2c1b4621ac1e05d9026f73065bd
  C_CHAIN_RPC_URL: http://127.0.0.1:9650/ext/bc/C/rpc
  MPC_GROUP_ID: 902656e8cdb467a7e2f30099f57437f53578ecfa61280fee99bcc7d42f070400

testcases:
  - name: readMpcManagerAddress
    steps:
      - type: readfile
        path: MYHOME/mpctest/contracts/addresses/MPC_MANAGER_ADDRESS
        vars:
          content:
            from: result.content
        assertions:
          - result.content ShouldNotBeEmpty

  - name: Request keygen with pre-defined group ID
    steps:
      - script: cast send --rpc-url {{.C_CHAIN_RPC_URL}} --from {{.ROLE_MPC_ADMIN}} --private-key {{.ROLE_MPC_ADMIN_PK}} --gas-limit 900000 {{.readMpcManagerAddress.content}} "requestKeygen(bytes32)" {{.MPC_GROUP_ID}}
        assertions: # todo: to improve assertion, plus check lastGenPubKey and lastGenAddress
          - result.systemout ShouldNotBeEmpty
